fix_eod_close: resolve virtual sell buy_record tracking and add failsafe sweep

P0-1: execute_virtual_sell uses metadata buy_record_id first, DB fallback without date filter
P0-2: Store buy_record_id in metadata after successful virtual buy
P1-1: Add 15:15 failsafe sweep for unclosed BUY records
P1-2: Add UNIQUE partial index on buy_record_id for SELL records

Co-Authored-By: Claude Opus 4.6 <noreply@anthropic.com>
